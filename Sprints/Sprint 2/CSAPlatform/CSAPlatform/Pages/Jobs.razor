@page "/jobs"
@using Blazorise
@using DatabaseAccess.Entities
@using DatabaseAccess.Enums
@inject NavigationManager NavigationManager

<PageTitle>Jobs</PageTitle>
<h2>Job Postings</h2>
<DataGrid TItem="JobPost"
          Data="@jobList"
          @bind-SelectedRow="@selectedJob"
          Editable
          Responsive
          ShowPager
          CommandMode="DataGridCommandMode.ButtonRow"
          EditMode="editMode">
    <DataGridColumns>
        <DataGridColumn Field="@nameof(JobPost.Id)" Caption="#Job ID#" Sortable="false" />
        <DataGridColumn Field="@nameof(JobPost.JobTitle)" Caption="Job Title"  />
        <DataGridColumn Field="@nameof(JobPost.CreationDate)" Caption="Creation Date"  />
        <DataGridColumn Field="@nameof(JobPost.ExpirationDate)" Caption="Expiration Date" />
        <DataGridColumn Field="@nameof(JobPost.Location)" Caption="Location" />
        <DataGridColumn Field="@nameof(JobPost.Status)" Caption="Status" />
        <!--<DataGridColumn Field="@nameof(JobPost.User.CompanyName)" Caption="Company" /> -->
        <DataGridColumn Field="@nameof(JobPost.JobType)" Caption="Type" />
    </DataGridColumns>

    <ButtonRowTemplate>
        <Button Color="Color.Success" Disabled="(selectedJob is null)" onclick="@(() => {NavigationManager.NavigateTo("/new");})">New</Button>
        <Button Color="Color.Primary" Disabled="true" Clicked="context.EditCommand.Clicked">Edit</Button>
        <Button Color="Color.Danger" Disabled="(selectedJob is null)" hidden="true" Clicked="context.DeleteCommand.Clicked">Delete</Button> 
    </ButtonRowTemplate>
</DataGrid>

@code {
    private List<JobPost> jobList = new List<JobPost> { };
    private JobPost selectedJob = new JobPost();
    private DataGridEditMode editMode = DataGridEditMode.Form;
    protected override async Task OnInitializedAsync()
    {
        //Placeholder jobs***********
        JobPost j1 = new JobPost() { JobTitle = "title1", JobType = JobType.Remote, Location = "canada", CreationDate = DateTime.Now, ExpirationDate = DateTime.Now, Status = PostStatusType.Open };
        JobPost j2 = new JobPost() { JobTitle = "title2", JobType = JobType.Remote, Location = "USA", CreationDate = DateTime.Now, ExpirationDate = DateTime.Now, Status = PostStatusType.Expired };
        jobList.Add(j1);
        jobList.Add(j2);

        await base.OnInitializedAsync();
    }
}
